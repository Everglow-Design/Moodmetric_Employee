<!DOCTYPE html>
<html lang="da">
<head>
        <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js"></script>
        <script>
            const SUPABASE_URL = 'https://rwksvrxfsjfdikckwmzq.supabase.co';
            const SUPABASE_ANON_KEY = 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InJ3a3N2cnhmc2pmZGlrY2t3bXpxIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NjczOTY5MTksImV4cCI6MjA4Mjk3MjkxOX0.rddfbx0API_R62uLWJdM5QCMmqIwc-9b6XpgfNsbsOk';
            const _supabase = supabase.createClient(SUPABASE_URL, SUPABASE_ANON_KEY);
        </script>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Dashboard</title>
    <style>
                .status-section {
                    margin-bottom: 24px;
                }
                .status-indicator {
                    display: inline-block;
                    width: 16px;
                    height: 16px;
                    border-radius: 50%;
                    background: #b0b8c9;
                    margin-left: 8px;
                    vertical-align: middle;
                }
                .checkin-section {
                    margin-bottom: 24px;
                }
                .checkin-form label {
                    display: block;
                    margin: 12px 0 6px 0;
                    color: #2a3a5e;
                    text-align: left;
                }
                .checkin-form input[type="range"] {
                    width: 100%;
                }
                .checkin-form .emoji-group {
                    display: flex;
                    justify-content: space-between;
                    margin: 8px 0 16px 0;
                }
                .checkin-form .emoji {
                    font-size: 1.6em;
                    cursor: pointer;
                    transition: transform 0.1s;
                }
                .checkin-form .emoji.selected {
                    transform: scale(1.2);
                    border-bottom: 2px solid #2a3a5e;
                }
                .checkin-form textarea {
                    width: 100%;
                    min-height: 40px;
                    border-radius: 6px;
                    border: 1px solid #cfd8dc;
                    padding: 8px;
                    font-size: 1em;
                    resize: none;
                }
                .checkin-form button {
                    width: 100%;
                    padding: 12px;
                    background: #2a3a5e;
                    color: #fff;
                    border: none;
                    border-radius: 6px;
                    font-size: 1.1em;
                    cursor: pointer;
                    margin-top: 16px;
                }
                .confirmation-section {
                    display: none;
                    margin-bottom: 24px;
                    color: #2a3a5e;
                    background: #eaf7f0;
                    border-radius: 10px;
                    padding: 18px 10px;
                }
                .insight-section {
                    margin-bottom: 18px;
                    color: #4a5a7e;
                    font-size: 1em;
                }
                .ai-feedback-section {
                    margin-bottom: 18px;
                    color: #6a7a9e;
                    font-size: 0.98em;
                    font-style: italic;
                }
                .nav-section {
                    display: flex;
                    justify-content: space-around;
                    margin-top: 18px;
                    border-top: 1px solid #e0e4ef;
                    padding-top: 12px;
                    font-size: 1.2em;
                }
                .nav-section a {
                    color: #2a3a5e;
                    text-decoration: none;
                    display: flex;
                    flex-direction: column;
                    align-items: center;
                }
                .nav-section a:active {
                    color: #4a5a7e;
                }
        body {
            min-height: 100vh;
            margin: 0;
            display: flex;
            align-items: center;
            justify-content: center;
            background: #f4f6fb;
            font-family: Arial, sans-serif;
        }
        .dashboard-container {
            background: #fff;
            border-radius: 18px;
            box-shadow: 0 2px 16px rgba(0,0,0,0.10);
            padding: 40px 32px;
            max-width: 420px;
            width: 90vw;
            text-align: center;
        }
        h1 {
            color: #2a3a5e;
            margin-bottom: 18px;
            font-size: 2em;
        }
        p {
            color: #4a5a7e;
            font-size: 1.1em;
        }
        @media (max-width: 600px) {
            .dashboard-container {
                padding: 24px 8vw;
                max-width: 98vw;
            }
            h1 {
                font-size: 1.3em;
            }
        }
    </style>
</head>
<body>
    <div class="dashboard-container">
        <!-- 1Ô∏è‚É£ Status / Overblik -->
        <div class="status-section">
            <div style="font-weight: bold;">Hvordan har du det i dag?</div>
            <div style="margin-top: 4px; color: #6a7a9e; font-size: 0.98em;">
                <span id="current-date"></span>
                <span class="status-indicator" title="Neutral status"></span>
            </div>
        </div>

        <!-- 2Ô∏è‚É£ Daglig check-in -->
        <div class="checkin-section" id="checkin-section">
            <form class="checkin-form" id="checkin-form">
                <label for="stress">Stressniveau</label>
                <input type="range" id="stress" name="stress" min="1" max="10" value="5">
                <div style="font-size:0.95em; color:#6a7a9e; margin-bottom:8px;">Lav (1) &nbsp;‚Äì&nbsp; H√∏j (10)</div>

                <label>Hum√∏r</label>
                <div class="emoji-group" id="mood-group">
                    <span class="emoji" data-value="glad" title="Glad">üòä</span>
                    <span class="emoji" data-value="neutral" title="Neutral">üòê</span>
                    <span class="emoji" data-value="trist" title="Trist">üòî</span>
                    <span class="emoji" data-value="tr√¶t" title="Tr√¶t">üò¥</span>
                </div>

                <label for="comment">Valgfri kommentar</label>
                <textarea id="comment" name="comment" maxlength="120" placeholder="Skriv evt. en kort kommentar..."></textarea>

                <button type="submit">Send check-in</button>
            </form>
        </div>

        <!-- 3Ô∏è‚É£ Bekr√¶ftelse efter check-in -->
        <div class="confirmation-section" id="confirmation-section">
            <div style="font-size:1.1em;">Tak ‚Äì din check-in er registreret</div>
        </div>

        <!-- 4Ô∏è‚É£ Kort personlig indsigt (MVP) -->
        <div class="insight-section" id="insight-section" style="display:none;">
            Du har checket ind 4 dage i tr√¶k
        </div>

        <!-- 5Ô∏è‚É£ AI-feedback (forsigtig) -->
        <div class="ai-feedback-section" id="ai-feedback-section" style="display:none;">
            Husk at tage pauser, hvis du f√∏ler dig presset
        </div>

        <!-- 6Ô∏è‚É£ Navigation -->
        <div class="nav-section">
            <a href="#" title="Dashboard">
                üè†<span style="font-size:0.8em;">Dashboard</span>
            </a>
            <a href="#" title="Min historik">
                üìä<span style="font-size:0.8em;">Min historik</span>
            </a>
            <a href="#" title="Indstillinger / Log ud">
                ‚öôÔ∏è<span style="font-size:0.8em;">Indstillinger</span>
            </a>
        </div>
    <script>
                // Hent brugerdata for den aktuelle bruger
                async function loadUserData() {
                    const { data: { user } } = await _supabase.auth.getUser();
                    if (!user) {
                        // Hvis ikke logget ind, send tilbage til login
                        window.location.href = 'index.html';
                        return;
                    }
                    // Hent evt. profiloplysninger fra din employee-tabel
                    const { data, error } = await _supabase
                        .from('PROFILES_EMPLOYEE')
                        .select('*')
                        .eq('id', user.id)
                        .single();
                    if (data && data.navn) {
                        // S√¶t navn/status i status-sektionen hvis √∏nsket
                        const statusSection = document.querySelector('.status-section');
                        const nameDiv = document.createElement('div');
                        nameDiv.style.fontSize = '1em';
                        nameDiv.style.color = '#2a3a5e';
                        nameDiv.textContent = 'Hej, ' + data.navn;
                        statusSection.appendChild(nameDiv);
                    }
                }
                loadUserData();
        // S√¶t dags dato
        document.getElementById('current-date').textContent = new Date().toLocaleDateString('da-DK', { weekday: 'long', year: 'numeric', month: 'long', day: 'numeric' });

        // Emoji hum√∏rvalg
        const moodGroup = document.getElementById('mood-group');
        let selectedMood = null;
        moodGroup.addEventListener('click', function(e) {
            if (e.target.classList.contains('emoji')) {
                Array.from(moodGroup.children).forEach(el => el.classList.remove('selected'));
                e.target.classList.add('selected');
                selectedMood = e.target.getAttribute('data-value');
            }
        });

        // Check-in form
        const checkinForm = document.getElementById('checkin-form');
        const checkinSection = document.getElementById('checkin-section');
        const confirmationSection = document.getElementById('confirmation-section');
        const insightSection = document.getElementById('insight-section');
        const aiFeedbackSection = document.getElementById('ai-feedback-section');

        checkinForm.addEventListener('submit', function(e) {
            e.preventDefault();
            (async () => {
                const stress = document.getElementById('stress').value;
                const comment = document.getElementById('comment').value;
                // Hent bruger
                const { data: { user } } = await _supabase.auth.getUser();
                if (!user) {
                    window.location.href = 'index.html';
                    return;
                }
                // Gem check-in i Supabase
                await _supabase.from('CHECKINS_EMPLOYEE').insert([
                    {
                        user_id: user.id,
                        dato: new Date().toISOString().slice(0,10),
                        stressniveau: parseInt(stress),
                        hum√∏r: selectedMood,
                        kommentar: comment
                    }
                ]);
                checkinSection.style.display = 'none';
                confirmationSection.style.display = 'block';
                // Vis evt. indsigt og AI-feedback (dummy i MVP)
                setTimeout(() => {
                    confirmationSection.style.display = 'none';
                    insightSection.style.display = 'block';
                    aiFeedbackSection.style.display = 'block';
                }, 1800);
            })();
        });
    </script>
    </div>
</body>
</html>
